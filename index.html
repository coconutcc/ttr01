<!DOCTYPE html>
<html>
  <head>
    <title>Embedding Vega-Lite</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.21.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.2"></script>
  </head>
  <body>
    <div id="vis"></div>

    <script type="text/javascript">
      var yourVlSpec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 1200,
  "height": 700,
  "layer": [
        {
          "data": {
            "url": "https://vega.github.io/editor/data/us-10m.json",
            "format": {
              "type": "topojson",
              "feature": "states"
            }
          },
          "mark": {
            "type": "geoshape",
            "fill": "lightgrey",
            "stroke": "white"
          }
        },
        {
          "data": {"url": "ttr/cities.json"},
          "encoding": {
            "latitude": {
              "field": "lat",
              "type": "quantitative"
            },
            "longitude": {
              "field": "long",
              "type": "quantitative"
            }
          },
          "layer": [
            {
              "mark": {
                "type": "circle",
                "color": "black",
                "size": 50
              }
            },
            {
              "mark": {
                "type": "text",
                "dy": -10
              },
              "encoding": {
                "text": { "field": "city", "type": "nominal" }
              }
            }
          ]
        },
        {
          "data": {"url": "ttr/game_states.json"},
          "transform": [
            {
              "lookup": "scity",
              "from": {
                "data": { "name": "cities" },
                "key": "city",
                "fields": ["lat", "long"]
              },
              "as": ["slat", "slong"]
            },
            {
              "lookup": "dcity",
              "from": {
                "data": {"url": "ttr/cities.json"},
                "key": "city",
                "fields": ["lat", "long"]
              },
              "as": ["dlat", "dlong"]
            }
          ],
            "projection": {
             "type": "albersUsa"
          },
          "mark": "rule",
          "encoding": {
            "color": {"field": "player"},
            "strokeWidth": {"field": "points"},
            "latitude": {
              "field": "slat",
              "type": "quantitative"
            },
            "longitude": {
              "field": "slong",
              "type": "quantitative"
            },
            "latitude2": {
              "field": "dlat",
              "type": "quantitative"
            },
            "longitude2": { 
              "field": "dlong",
              "type": "quantitative"
            }
        }
      }
    ]
  };
      vegaEmbed('#vis', yourVlSpec);
    </script>
  </body>
</html>